{
  "annotations": {
    "list": [
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "node_boot_time_seconds{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}*1000 > $__from < $__to",
        "hide": true,
        "iconColor": "light-yellow",
        "name": "Reboot",
        "tagKeys": "job,instance",
        "titleFormat": "Reboot",
        "useValueForTime": "on"
      }
    ]
  },
  "editable": false,
  "id": null,
  "links": [
    {
      "asDropdown": true,
      "includeVars": true,
      "keepTime": true,
      "tags": [
        "macos-node-integration"
      ],
      "title": "All MacOS /  dashboards",
      "type": "dashboards"
    }
  ],
  "panels": [
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "description": "Shows if metrics are being received for the selected time range.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "fixed"
          },
          "mappings": [
            {
              "options": {
                "match": "null",
                "result": {
                  "color": "light-red",
                  "index": 0,
                  "text": "No metrics received - Check configuration"
                }
              },
              "type": "special"
            },
            {
              "options": {
                "from": 0,
                "result": {
                  "color": "light-red",
                  "index": 1,
                  "text": "Failed to collect metrics"
                },
                "to": 0
              },
              "type": "range"
            },
            {
              "options": {
                "from": 1,
                "result": {
                  "color": "light-green",
                  "index": 2,
                  "text": "Receiving metrics"
                },
                "to": 1000000
              },
              "type": "range"
            }
          ],
          "noValue": "No data",
          "unit": "string"
        }
      },
      "gridPos": {
        "h": 2,
        "w": 8,
        "x": 0,
        "y": 0
      },
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "pluginVersion": "v10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "expr": "vector(1) and on() ((count(up{job=~\"$job\"} == 1) > 0) and (absent(absent(node_uname_info{job=~\"$job\"})))) or vector(0) and on() ((count(up{job=~\"$job\"}) > 0) and (absent(node_uname_info{job=~\"$job\"})))\n"
        }
      ],
      "title": "Metrics",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "description": "Shows the timestamp of the latest metrics received for this integration in the last 24 hours.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "fixed"
          },
          "noValue": "No data",
          "unit": "dateTimeFromNow"
        }
      },
      "gridPos": {
        "h": 2,
        "w": 8,
        "x": 8,
        "y": 0
      },
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "Time"
        }
      },
      "pluginVersion": "v10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "$datasource"
          },
          "expr": "vector(1) and on() ((count(up{job=~\"$job\"} == 1) > 0) and (absent(absent(node_uname_info{job=~\"$job\"})))) or vector(0) and on() ((count(up{job=~\"$job\"}) > 0) and (absent(node_uname_info{job=~\"$job\"})))\n"
        }
      ],
      "timeFrom": "now-24h",
      "title": "Latest metrics received",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "description": "Shows the installed version of this integration.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "fixed"
          },
          "noValue": "1.0.2",
          "unit": "string"
        }
      },
      "gridPos": {
        "h": 2,
        "w": 8,
        "x": 16,
        "y": 0
      },
      "pluginVersion": "v10.0.0",
      "title": "Integration version",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 0,
        "x": 0,
        "y": 3
      },
      "id": 1,
      "title": "Overview",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "The duration of time that has passed since the last reboot or system start.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "thresholds"
          },
          "decimals": 1,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "orange",
                "value": null
              },
              {
                "color": "text",
                "value": 600
              }
            ]
          },
          "unit": "dtdurations"
        }
      },
      "gridPos": {
        "h": 2,
        "w": 6,
        "x": 0,
        "y": 4
      },
      "id": 2,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "time() - node_boot_time_seconds{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}"
        }
      ],
      "title": "Uptime",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "System's hostname.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "fixed"
          }
        }
      },
      "gridPos": {
        "h": 2,
        "w": 6,
        "x": 6,
        "y": 4
      },
      "id": 3,
      "options": {
        "colorMode": "fixed",
        "graphMode": "none",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "/^nodename$/"
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_uname_info{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}",
          "format": "table"
        }
      ],
      "title": "Hostname",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Kernel version of linux host.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "fixed"
          }
        }
      },
      "gridPos": {
        "h": 2,
        "w": 6,
        "x": 12,
        "y": 4
      },
      "id": 4,
      "options": {
        "colorMode": "fixed",
        "graphMode": "none",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "/^release$/"
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_uname_info{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}",
          "format": "table"
        }
      ],
      "title": "Kernel version",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Operating system",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "fixed"
          }
        }
      },
      "gridPos": {
        "h": 2,
        "w": 6,
        "x": 18,
        "y": 4
      },
      "id": 5,
      "options": {
        "colorMode": "fixed",
        "graphMode": "none",
        "reduceOptions": {
          "fields": "/^version$/"
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_os_info{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}\n",
          "format": "table"
        }
      ],
      "title": "OS version",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "CPU count is the number of processor cores or central processing units (CPUs) in a computer,\ndetermining its processing capability and ability to handle tasks concurrently.\n",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "fixed"
          },
          "unit": "none"
        }
      },
      "gridPos": {
        "h": 2,
        "w": 6,
        "x": 0,
        "y": 6
      },
      "id": 6,
      "options": {
        "colorMode": "fixed",
        "graphMode": "none",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "count without (cpu) (node_cpu_seconds_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\", mode=\"idle\"})",
          "legendFormat": "Cores"
        }
      ],
      "title": "CPU count",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Amount of random-access memory (RAM) installed.\nIt represents the system's available working memory that applications and the operating system use to perform tasks.\nA higher memory total generally leads to better system performance and the ability to run more demanding applications and processes simultaneously.\n",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "fixed"
          },
          "unit": "bytes"
        }
      },
      "gridPos": {
        "h": 2,
        "w": 6,
        "x": 6,
        "y": 6
      },
      "id": 7,
      "options": {
        "colorMode": "fixed",
        "graphMode": "none",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_memory_total_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}",
          "legendFormat": "Physical memory"
        }
      ],
      "title": "Memory total",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Total swap available.\n\nSwap is a space on a storage device (usually a dedicated swap partition or a swap file) \nused as virtual memory when the physical RAM (random-access memory) is fully utilized.\nSwap space helps prevent memory-related performance issues by temporarily transferring less-used data from RAM to disk,\nfreeing up physical memory for active processes and applications.\n",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "fixed"
          },
          "unit": "bytes"
        }
      },
      "gridPos": {
        "h": 2,
        "w": 6,
        "x": 12,
        "y": 6
      },
      "id": 8,
      "options": {
        "colorMode": "fixed",
        "graphMode": "none",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_memory_swap_total_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}"
        }
      ],
      "title": "Total swap",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Total capacity on the primary mount point /.\n",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "fixed"
          },
          "unit": "bytes"
        }
      },
      "gridPos": {
        "h": 2,
        "w": 6,
        "x": 18,
        "y": 6
      },
      "id": 9,
      "options": {
        "colorMode": "fixed",
        "graphMode": "none",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_filesystem_size_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\", mountpoint=\"/\", fstype!=\"rootfs\"}"
        }
      ],
      "title": "Root mount size",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 0,
        "x": 24,
        "y": 8
      },
      "id": 10,
      "title": "CPU",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Total CPU utilization percent is a metric that indicates the overall level of central processing unit (CPU) usage in a computer system.\nIt represents the combined load placed on all CPU cores or processors.\n\nFor instance, if the total CPU utilization percent is 50%, it means that,\non average, half of the CPU's processing capacity is being used to execute tasks. A higher percentage indicates that the CPU is working more intensively, potentially leading to system slowdowns if it remains consistently high.\n",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "continuous-BlYlRd"
          },
          "decimals": 1,
          "max": 100,
          "min": 0,
          "unit": "percent"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 6,
        "x": 0,
        "y": 9
      },
      "id": 11,
      "options": {
        "colorMode": "value",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "(((count by (instance) (count(node_cpu_seconds_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}) by (cpu, instance))) \n- \navg by (instance) (sum by (instance, mode)(irate(node_cpu_seconds_total{mode='idle',job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}[$__rate_interval])))) * 100) \n/ \ncount by(instance) (count(node_cpu_seconds_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}) by (cpu, instance))\n",
          "legendFormat": "CPU usage"
        }
      ],
      "title": "CPU usage",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Total CPU utilization percent is a metric that indicates the overall level of central processing unit (CPU) usage in a computer system.\nIt represents the combined load placed on all CPU cores or processors.\n\nFor instance, if the total CPU utilization percent is 50%, it means that,\non average, half of the CPU's processing capacity is being used to execute tasks. A higher percentage indicates that the CPU is working more intensively, potentially leading to system slowdowns if it remains consistently high.\n",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlYlRd"
          },
          "custom": {
            "fillOpacity": 30,
            "gradientMode": "scheme",
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "showPoints": "never",
            "stacking": {
              "mode": "normal"
            }
          },
          "decimals": 1,
          "max": 100,
          "min": 0,
          "unit": "percent"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 6,
        "y": 9
      },
      "id": 12,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "(\n  (1 - sum without (mode) (rate(node_cpu_seconds_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\", mode=~\"idle|iowait|steal\"}[$__rate_interval])))\n/ ignoring(cpu) group_left\n  count without (cpu, mode) (node_cpu_seconds_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\", mode=\"idle\"})\n) * 100\n",
          "legendFormat": "CPU {{cpu}}"
        }
      ],
      "title": "CPU usage",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "System load average over the previous 1, 5, and 15 minute ranges.\n\nA measurement of how many processes are waiting for CPU cycles. The maximum number is the number of CPU cores for the node.\n",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "fillOpacity": 0,
            "gradientMode": "opacity",
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "showPoints": "never"
          },
          "min": 0,
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byRegexp",
              "options": "Cores"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "light-orange",
                  "mode": "fixed"
                }
              },
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "custom.lineStyle",
                "value": {
                  "dash": [
                    10,
                    10
                  ],
                  "fill": "dash"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 6,
        "w": 6,
        "x": 18,
        "y": 9
      },
      "id": 13,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_load1{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}",
          "legendFormat": "1m"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_load5{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}",
          "legendFormat": "5m"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_load15{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}",
          "legendFormat": "15m"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "count without (cpu) (node_cpu_seconds_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\", mode=\"idle\"})",
          "legendFormat": "Cores"
        }
      ],
      "title": "Load average",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 0,
        "x": 24,
        "y": 15
      },
      "id": 14,
      "title": "Memory",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "RAM (random-access memory) currently in use by the operating system and running applications, in percent.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "continuous-BlYlRd"
          },
          "decimals": 1,
          "max": 100,
          "min": 0,
          "unit": "percent"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 6,
        "x": 0,
        "y": 16
      },
      "id": 15,
      "options": {
        "colorMode": "value",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "(\n    (\n      avg(node_memory_internal_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}) -\n      avg(node_memory_purgeable_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}) +\n      avg(node_memory_wired_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}) +\n      avg(node_memory_compressed_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"})\n    ) /\n    avg(node_memory_total_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"})\n)\n*\n100\n"
        }
      ],
      "title": "Memory usage",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "- Physical memory: Total amount of memory installed in this computer;\n- App memory: Physical memory allocated by apps and system processes;\n- Wired memory: Physical memory, containing data that cannot be compressed or swapped to disk;\n- Compressed memory: Physical memory used to store a compressed version of data that has not been used recently;\n- Swap used: Amount of compressed data temporarily moved to disk to make room in memory for more recently used data.\n",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "fillOpacity": 30,
            "gradientMode": "opacity",
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "showPoints": "never"
          },
          "min": 0,
          "unit": "bytes"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byRegexp",
              "options": ".*(T|t)otal.*"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "light-orange",
                  "mode": "fixed"
                }
              },
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "custom.lineStyle",
                "value": {
                  "dash": [
                    10,
                    10
                  ],
                  "fill": "dash"
                }
              }
            ]
          },
          {
            "__systemRef": "hideSeriesFrom",
            "matcher": {
              "id": "byNames",
              "options": {
                "mode": "exclude",
                "names": [
                  "Physical memory",
                  "Memory used"
                ],
                "prefix": "All except:",
                "readOnly": true
              }
            },
            "properties": [
              {
                "id": "custom.hideFrom",
                "value": {
                  "legend": false,
                  "tooltip": false,
                  "viz": true
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byRegexp",
              "options": "Physical memory"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "light-orange",
                  "mode": "fixed"
                }
              },
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "custom.lineStyle",
                "value": {
                  "dash": [
                    10,
                    10
                  ],
                  "fill": "dash"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 6,
        "w": 18,
        "x": 6,
        "y": 16
      },
      "id": 16,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "(\n  node_memory_internal_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"} -\n  node_memory_purgeable_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"} +\n  node_memory_wired_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"} +\n  node_memory_compressed_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}\n)\n",
          "legendFormat": "Memory used"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_memory_total_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}",
          "legendFormat": "Physical memory"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "(\n    node_memory_internal_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"} -\n    node_memory_purgeable_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}\n)\n",
          "legendFormat": "App memory"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_memory_wired_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}",
          "legendFormat": "Wired memory"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_memory_compressed_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}",
          "legendFormat": "Compressed memory"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_memory_swap_used_bytes{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}",
          "legendFormat": "Swap used"
        }
      ],
      "title": "Memory usage",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 0,
        "x": 24,
        "y": 22
      },
      "id": 17,
      "title": "Disk",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Disk read/writes in bytes per second.",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "fillOpacity": 1,
            "gradientMode": "opacity",
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "showPoints": "never"
          },
          "unit": "Bps"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byRegexp",
              "options": "/time|used|busy|util/"
            },
            "properties": [
              {
                "id": "custom.axisSoftMax",
                "value": 100
              },
              {
                "id": "custom.drawStyle",
                "value": "points"
              },
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 23
      },
      "id": 18,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "irate(node_disk_read_bytes_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\", device!=\"\"}[$__rate_interval])",
          "legendFormat": "{{ device }} read"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "irate(node_disk_written_bytes_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\", device!=\"\"}[$__rate_interval])",
          "legendFormat": "{{ device }} written"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "irate(node_disk_io_time_seconds_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\", device!=\"\"}[$__rate_interval])",
          "legendFormat": "{{ device }} io util"
        }
      ],
      "title": "Disk reads/writes",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Disk utilisation in percent, by mountpoint. Some duplication can occur if the same filesystem is mounted in multiple locations.",
      "fieldConfig": {
        "defaults": {
          "thresholds": {
            "steps": [
              {
                "color": "light-blue",
                "value": null
              },
              {
                "color": "light-yellow",
                "value": 0.8
              },
              {
                "color": "light-red",
                "value": 0.9
              }
            ]
          },
          "unit": "bytes"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Mounted on"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": "260"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Size"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": "80"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Used"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": "80"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Available"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": "80"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Used, %"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              },
              {
                "id": "max",
                "value": 1
              },
              {
                "id": "min",
                "value": 0
              },
              {
                "id": "unit",
                "value": "percentunit"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 23
      },
      "id": 19,
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_filesystem_size_bytes{fstype!=\"\", mountpoint!=\"\", job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}",
          "format": "table",
          "instant": true,
          "refId": "TOTAL"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "node_filesystem_avail_bytes{fstype!=\"\", mountpoint!=\"\", job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}",
          "format": "table",
          "instant": true,
          "legendFormat": "{{ mountpoint }} free",
          "refId": "FREE"
        }
      ],
      "title": "Disk space usage",
      "transformations": [
        {
          "id": "groupBy",
          "options": {
            "fields": {
              "Value #FREE": {
                "aggregations": [
                  "lastNotNull"
                ],
                "operation": "aggregate"
              },
              "Value #TOTAL": {
                "aggregations": [
                  "lastNotNull"
                ],
                "operation": "aggregate"
              },
              "mountpoint": {
                "aggregations": [],
                "operation": "groupby"
              }
            }
          }
        },
        {
          "id": "merge",
          "options": {}
        },
        {
          "id": "calculateField",
          "options": {
            "alias": "Used",
            "binary": {
              "left": "Value #TOTAL (lastNotNull)",
              "operator": "-",
              "reducer": "sum",
              "right": "Value #FREE (lastNotNull)"
            },
            "mode": "binary",
            "reduce": {
              "reducer": "sum"
            }
          }
        },
        {
          "id": "calculateField",
          "options": {
            "alias": "Used, %",
            "binary": {
              "left": "Used",
              "operator": "/",
              "reducer": "sum",
              "right": "Value #TOTAL (lastNotNull)"
            },
            "mode": "binary",
            "reduce": {
              "reducer": "sum"
            }
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {},
            "indexByName": {
              "Used": 3,
              "Used, %": 4,
              "Value #FREE (lastNotNull)": 2,
              "Value #TOTAL (lastNotNull)": 1,
              "mountpoint": 0
            },
            "renameByName": {
              "Value #FREE (lastNotNull)": "Available",
              "Value #TOTAL (lastNotNull)": "Size",
              "mountpoint": "Mounted on"
            }
          }
        },
        {
          "id": "sortBy",
          "options": {
            "fields": {},
            "sort": [
              {
                "desc": false,
                "field": "Mounted on"
              }
            ]
          }
        }
      ],
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 0,
        "x": 24,
        "y": 31
      },
      "id": 20,
      "title": "Network",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Network traffic (bits per sec) measures data transmitted and received.",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "axisCenteredZero": false,
            "axisLabel": "out(-) | in(+)",
            "fillOpacity": 30,
            "gradientMode": "opacity",
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "showPoints": "never"
          },
          "decimals": 1,
          "unit": "bps"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byRegexp",
              "options": "/transmit|tx|out/"
            },
            "properties": [
              {
                "id": "custom.transform",
                "value": "negative-Y"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 32
      },
      "id": 21,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "irate(node_network_receive_bytes_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}[$__rate_interval])*8\n# only show interfaces that had traffic change at least once during selected dashboard interval:\nand\nincrease(\n    node_network_receive_bytes_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}[$__range]\n    ) > 0\n",
          "legendFormat": "{{ device }} received"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "irate(node_network_transmit_bytes_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}[$__rate_interval])*8\n# only show interfaces that had traffic change at least once during selected dashboard interval:\nand\nincrease(\n    node_network_transmit_bytes_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}[$__range]\n    ) > 0\n",
          "legendFormat": "{{ device }} transmitted"
        }
      ],
      "title": "Network traffic",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "**Network errors**:\n\nNetwork errors refer to issues that occur during the transmission of data across a network. \n\nThese errors can result from various factors, including physical issues, jitter, collisions, noise and interference.\n\nMonitoring network errors is essential for diagnosing and resolving issues, as they can indicate problems with network hardware or environmental factors affecting network quality.\n\n**Dropped packets**:\n\nDropped packets occur when data packets traveling through a network are intentionally discarded or lost due to congestion, resource limitations, or network configuration issues. \n\nCommon causes include network congestion, buffer overflows, QoS settings, and network errors, as corrupted or incomplete packets may be discarded by receiving devices.\n\nDropped packets can impact network performance and lead to issues such as degraded voice or video quality in real-time applications.\n",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "axisCenteredZero": false,
            "axisLabel": "out(-) | in(+)",
            "fillOpacity": 30,
            "gradientMode": "opacity",
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "showPoints": "never"
          },
          "decimals": 1,
          "noValue": "No errors",
          "unit": "pps"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byRegexp",
              "options": "/transmit|tx|out/"
            },
            "properties": [
              {
                "id": "custom.transform",
                "value": "negative-Y"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 32
      },
      "id": 22,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "v11.0.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "irate(node_network_transmit_errs_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}[$__rate_interval])>0",
          "legendFormat": "{{ device }} errors transmitted"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "irate(node_network_receive_errs_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}[$__rate_interval])>0",
          "legendFormat": "{{ device }} errors received"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "irate(node_network_transmit_drop_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}[$__rate_interval])>0",
          "legendFormat": "{{ device }} transmitted dropped"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "expr": "irate(node_network_receive_drop_total{job=\"integrations/macos-node\",job=~\"$job\",instance=~\"$instance\"}[$__rate_interval])>0",
          "legendFormat": "{{ device }} received dropped"
        }
      ],
      "title": "Network errors and dropped packets",
      "type": "timeseries"
    }
  ],
  "refresh": "30s",
  "schemaVersion": 36,
  "tags": [
    "macos-node-integration"
  ],
  "templating": {
    "list": [
      {
        "label": "Data source",
        "name": "datasource",
        "query": "prometheus",
        "regex": "(?!grafanacloud-usage|grafanacloud-ml-metrics).+",
        "type": "datasource"
      },
      {
        "allValue": ".+",
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "includeAll": true,
        "label": "Job",
        "multi": true,
        "name": "job",
        "query": "label_values(node_uname_info{job=\"integrations/macos-node\"}, job)",
        "refresh": 2,
        "sort": 1,
        "type": "query"
      },
      {
        "allValue": ".+",
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "includeAll": false,
        "label": "Instance",
        "multi": false,
        "name": "instance",
        "query": "label_values(node_uname_info{job=\"integrations/macos-node\",job=~\"$job\"}, instance)",
        "refresh": 2,
        "sort": 1,
        "type": "query"
      },
      {
        "hide": 2,
        "label": "Loki data source",
        "name": "loki_datasource",
        "query": "loki",
        "regex": "(?!grafanacloud.+usage-insights|grafanacloud.+alert-state-history).+",
        "type": "datasource"
      }
    ]
  },
  "time": {
    "from": "now-30m",
    "to": "now"
  },
  "timezone": "default",
  "title": "MacOS / overview",
  "uid": "darwin-overview",
  "version": 1
}